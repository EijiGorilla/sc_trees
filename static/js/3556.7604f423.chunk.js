"use strict";(self.webpackChunksc_trees=self.webpackChunksc_trees||[]).push([[3556],{21389:(e,t,n)=>{function o(){return[1,0,0,0,1,0,0,0,1]}function i(e,t,n,o,i,s,r,c,d){return[e,t,n,o,i,s,r,c,d]}n.d(t,{Ue:()=>o,Wd:()=>s,al:()=>i});const s=[1,0,0,0,1,0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:s,clone:function(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},create:o,createView:function(e,t){return new Float64Array(e,t,9)},fromValues:i},Symbol.toStringTag,{value:"Module"}))},85981:(e,t,n)=>{n.d(t,{Jk:()=>a,Ue:()=>d,ct:()=>g,nF:()=>h,zk:()=>u});var o=n(16889),i=n(21530),s=n(32035),r=n(12400),c=n(11185);function d(e){return e?{origin:(0,r.d9)(e.origin),vector:(0,r.d9)(e.vector)}:{origin:(0,r.Ue)(),vector:(0,r.Ue)()}}function u(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d();return(0,s.c)(n.origin,e),(0,s.d)(n.vector,t,e),n}function a(e,t){const n=(0,s.d)(c.WM.get(),t,e.origin),i=(0,s.f)(e.vector,n),r=(0,s.f)(e.vector,e.vector),d=(0,o.uZ)(i/r,0,1),u=(0,s.d)(c.WM.get(),(0,s.h)(c.WM.get(),e.vector,d),n);return(0,s.f)(u,u)}function h(e,t,n){return g(e,t,0,1,n)}function g(e,t,n,i,r){const{vector:d,origin:u}=e,a=(0,s.d)(c.WM.get(),t,u),h=(0,s.f)(d,a)/(0,s.k)(d);return(0,s.h)(r,d,(0,o.uZ)(h,n,i)),(0,s.g)(r,r,e.origin)}(0,r.Ue)(),(0,r.Ue)(),new i.x((()=>d()))},50319:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});var o=n(27366),i=n(66978),s=(n(32718),n(93169),n(84936),n(10064),n(69912)),r=n(32035),c=n(12400),d=n(85981),u=n(83479),a=n(78329),h=n(70423);function g(e,t,n){const o=(0,u.c)(),i=(0,u.a)(o);return(0,r.b)(i,i,e,.5),(0,r.b)(i,i,t,.5),o[3]=(0,r.j)(i,e),(0,r.g)(i,i,n),o}let p=class{constructor(){this._idToComponent=new Map,this._components=new a.Z((e=>e.bounds)),this._edges=new a.Z((e=>e.bounds)),this._tmpLineSegment=(0,d.Ue)(),this._tmpP1=(0,c.Ue)(),this._tmpP2=(0,c.Ue)(),this._tmpP3=(0,c.Ue)(),this.remoteClient=null}async fetchCandidates(e,t){await Promise.resolve(),(0,i.k_)(t),await this._ensureEdgeLocations(e,t);const n=[];return this._edges.forEachNeighbor((t=>(this._addCandidates(e,t,n),n.length<1e3)),e.bounds),{result:{candidates:n}}}async _ensureEdgeLocations(e,t){const n=[];if(this._components.forEachNeighbor((e=>{if(null==e.info){const{id:t,uid:o}=e;n.push({id:t,uid:o})}return!0}),e.bounds),!n.length)return;const o={components:n},i=await this.remoteClient.invoke("fetchAllEdgeLocations",o,t??{});for(const s of i.components)this._setFetchEdgeLocations(s)}async add(e){const t=new _(e.id,e.bounds);return this._idToComponent.set(t.id,t),this._components.add([t]),{result:{}}}async remove(e){const t=this._idToComponent.get(e.id);if(t){const e=[];this._edges.forEachNeighbor((n=>(n.component===t&&e.push(n),!0)),t.bounds),this._edges.remove(e),this._components.remove([t]),this._idToComponent.delete(t.id)}return{result:{}}}_setFetchEdgeLocations(e){const t=this._idToComponent.get(e.id);if(null==t||e.uid!==t.uid)return;const n=h.n_.createView(e.locations),o=new Array(n.count),i=(0,c.Ue)(),s=(0,c.Ue)();for(let c=0;c<n.count;c++){n.position0.getVec(c,i),n.position1.getVec(c,s);const r=g(i,s,e.origin),d=new m(t,c,r);o[c]=d}this._edges.add(o);const{objectIds:r,origin:d}=e;t.info={locations:n,objectIds:r,origin:d}}_addCandidates(e,t,n){const{info:o}=t.component,{origin:i,objectIds:s}=o,c=o.locations,d=c.position0.getVec(t.index,this._tmpP1),u=c.position1.getVec(t.index,this._tmpP2);(0,r.g)(d,d,i),(0,r.g)(u,u,i);const a=s[c.componentIndex.get(t.index)];this._addEdgeCandidate(e,a,d,u,n),f(e,a,d,n),f(e,a,u,n)}_addEdgeCandidate(e,t,n,o,i){if(!e.returnEdge)return;const s=(0,u.a)(e.bounds),a=(0,d.zk)(n,o,this._tmpLineSegment),h=(0,d.nF)(a,s,this._tmpP3);(0,u.o)(e.bounds,h)&&i.push({type:"edge",objectId:t,target:(0,c.d9)(h),distance:(0,r.j)(s,h),start:(0,c.d9)(n),end:(0,c.d9)(o)})}};p=(0,o._)([(0,s.j)("esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorker")],p);const l=p;function f(e,t,n,o){if(!e.returnVertex||!(0,u.o)(e.bounds,n))return;const i=(0,u.a)(e.bounds);o.push({type:"vertex",objectId:t,target:(0,c.d9)(n),distance:(0,r.j)(i,n)})}class _{constructor(e,t){this.id=e,this.bounds=t,this.info=null,this.uid=++_.uid}}_.uid=0;class m{constructor(e,t,n){this.component=e,this.index=t,this.bounds=n}}}}]);
//# sourceMappingURL=3556.7604f423.chunk.js.map